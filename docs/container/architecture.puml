@startuml

package adapters {
    package controller {
        /' --- implements on RPC --- '/
        class ContainerUser {
            CreateContainer()
            GetContainers()
            UpdateContainer()
            DeleteContainer()
        }
    }
    package gateway {
        class ContainerGatewayOnRDB {
            Insert(): error
            SelectByUserID(): ([]Container,error)
            Update(): error
            Delete(): error
        }
        class ContainerManifestGatewayOnDocument {
            Insert(): error
            Find(): ([]ContainerManifest,error)
            Update(): error
            Delete(): error
        }
        class AuthGatewayOnHTTP {
            Get(): (UserInfo, error)
            Post(): error
        }
        class KubernetesGatewayOnHTTP {
            ApplyManifest(): error
            DeleteManifest(): error
        }
    }
}

package application {
    package usecase {
        /' --- interface --- '/
        interface ContainerCreateUsecase {
            Execute(): error
        }
        interface ContainerReadUsecase {
            Execute()
        }
        interface ContainerDeleteUsecase {
            Execute()
        }
        /' --- instance --- '/
        class ContainerCreateInteractor {
            NewContainerCreateInteractor(): ContainerCreateUsecase
        }
        class ContainerReadInteractor {
            NewContainerReadInteractor(): ContainerReadUsecase
        }
        class ContainerDeleteInteractor {
            NewContainerDeleteInteractor(): ContainerDeleteUsecase
        }
    }
}



package domain {
    package model {
        /'Value Object'/
        class Container {
            /' --- field --- '/
            ID: ContainerID
            ImageName: ContainerImageName
            URL: ContainerURL
            Condition: ContainerCondition
            /' --- func --- '/
            NewContainer() (*Container, error)
        }
        class ContainerID {}
        class ContainerImageName {}
        /'ex) harbor.${MY_DOMAIN}/my_rbac_test_project/kuard-amd64:blue'/
        class ContainerURL {}
        class ContainerCondition {}
        /'ex) True, False, Unknown'/

        class ContainerManifest {
            /' --- field --- '/
            ContainerID: ContainerID
            ManifestStr: ManifestStr
            /' --- func --- '/
            NewContainerManifest() (*ContainerManifest, error)
        }
        class ManifestStr {}
    }
    package service {
    }
    package repository {
        interface ContainerRepository {}
        interface ContainerManifestRepository {}
        interface AuthRepository {}
        interface KubernetesRepository {}
    }
}

/' controller ..> usecase '/
ContainerUser ..> ContainerCreateUsecase
ContainerUser ..> ContainerReadUsecase
ContainerUser ..> ContainerDeleteUsecase

/'usecase ..> gateway '/
ContainerCreateInteractor ..> ContainerRepository
ContainerReadInteractor ..> ContainerRepository
ContainerDeleteInteractor ..> ContainerRepository
/'implements'/
ContainerCreateInteractor ..|> ContainerCreateUsecase
ContainerReadInteractor ..|> ContainerReadUsecase
ContainerDeleteInteractor ..|> ContainerDeleteUsecase

/' gateway ..> repository '/

/'implements'/
AuthGatewayOnHTTP ..|> AuthRepository
ContainerGatewayOnRDB ..|> ContainerRepository
ContainerManifestGatewayOnDocument ..|> ContainerManifestRepository
KubernetesGatewayOnHTTP ..|> KubernetesRepository

/' domain model '/
Container *-- ContainerID
Container *-- ContainerImageName
Container *-- ContainerURL
Container *-- ContainerCondition

ContainerManifest *-- ContainerID
ContainerManifest *-- ManifestStr
@enduml